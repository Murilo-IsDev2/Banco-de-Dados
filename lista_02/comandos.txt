--8.	Liste todos os pacientes (nome e data_cadastro)

SELECT 
    p.nome,
    pa.data_cadastro
FROM 
    paciente pa
JOIN pessoa p ON pa.pessoa_id = p.id;

9.	Liste todos os médicos (nome, crm, especialidade)

SELECT 
    p.nome,
    me.crm,
    esp.nome AS especialidade
FROM 
    medico me JOIN especialidade esp ON me.especialidade_id = esp.id
JOIN pessoa p ON me.pessoa_id = p.id;


--id, logradouro, numero, complemento, bairro, cidade, uf, cep
--criar tabela endereco

CREATE TABLE endereco(
  id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  logradouro varchar(255),
  numero varchar(20),
  complemento varchar(100),
  bairro varchar(100),
  cidade varchar(100),
  uf char(2),
  cep varchar(9)
);

-- O MEU
INSERT INTO endereco(logradouro, numero)
SELECT DISTINCT logradouro, numero FROM pessoa p WHERE p.logradouro IS NOT NULL AND p.numero IS NOT NULL;

--O CERTO
--ele respeita o nome do campo (não a sequência)
INSERT INTO endereco(logradouro, numero)
SELECT
    p.logradouro
    p.numero
FROM
    pessoa p;

INSERT INTO especialidade (nome)
SELECT DISTINCT especialidade FROM medico WHERE especialidade IS NOT NULL;

--funciona apenas porque estamos copiando e colando de uma tabela para outra, se tivessem ids


ALTER TABLE
    pessoa
ADD COLUMN
    endereco_id INT;


UPDATE
    pessoa p
    SET endereco_id = e.id,
    FROM endereco e
    WHERE p.id = e.id;

